!function(e){var t=[[{base:"`",alt:"~"},{base:"1",alt:"!"},{base:"2",alt:"@"},{base:"3",alt:"#"},{base:"4",alt:"$"},{base:"5",alt:"%"},{base:"6",alt:"^"},{base:"7",alt:"&"},{base:"8",alt:"*"},{base:"9",alt:"("},{base:"0",alt:")"},{base:"-",alt:"_"},{base:"=",alt:"+"},{base:"Backspace",alt:"DEL",ctrl:!0,keyCode:"Backspace",className:"backspace-key",keySize:5}],[{base:"Tab",alt:"Tab",ctrl:!0,keyCode:"Tab",className:"tab-key",keySize:3},{base:"q",alt:"Q"},{base:"w",alt:"W"},{base:"e",alt:"E"},{base:"r",alt:"R"},{base:"t",alt:"T"},{base:"y",alt:"Y"},{base:"u",alt:"U"},{base:"i",alt:"I"},{base:"o",alt:"O"},{base:"p",alt:"P"},{base:"[",alt:"{"},{base:"]",alt:"}"},{base:"\\",alt:"|",keySize:3}],[{base:"Caps Lock",alt:"CAPS",ctrl:!0,keyCode:"CapsLock",className:"capslock-key",keySize:4},{base:"a",alt:"A"},{base:"s",alt:"S"},{base:"d",alt:"D"},{base:"f",alt:"F"},{base:"g",alt:"G"},{base:"h",alt:"H"},{base:"j",alt:"J"},{base:"k",alt:"K"},{base:"l",alt:"L"},{base:";",alt:":"},{base:"'",alt:'"'},{base:"Enter",alt:"Enter",ctrl:!0,keySize:"6",keyCode:"Enter",className:"enter-key"}],[{base:"Shift",alt:"Shift",ctrl:!0,keySize:"6",keyCode:"Shift",className:"shift-key"},{base:"z",alt:"Z"},{base:"x",alt:"X"},{base:"c",alt:"C"},{base:"v",alt:"V"},{base:"b",alt:"B"},{base:"n",alt:"N"},{base:"m",alt:"M"},{base:",",alt:"<"},{base:".",alt:">"},{base:"/",alt:"?"},{base:"Shift",alt:"Shift",ctrl:!0,keyCode:"Shift",keySize:"8",className:"shift-key"}],[{base:"Space",alt:"Space",ctrl:!0,keySize:"10",keyCode:"Space",className:"space-key"}]];e.shDefaultLayout=t}(window),function(e){var t=function(t){var a={};this.options=e.extend({},a,t),this.element=this.options.element||null,this.element=this.element&&jQuery(this.element),this.capsLock=!1,this.shift=!1,this.layout=this.options.layout||shDefaultLayout};t.prototype={_attachEvents:function(){var t=this;this.input=this.element.find(".sh-keyboard-textarea"),this.input.on("click",function(){return!1}),this.input.on("keydown",function(t,a){if(t.originalEvent)return!1;var s=e(this).val(),l=this.selectionStart,i=(this.selectionEnd,s.split(""));return 8===t.which?(this.selectionEnd-this.selectionStart>0?i.splice(this.selectionStart,this.selectionEnd-this.selectionStart):this.selectionStart>0&&i.splice(this.selectionStart-1,1),e(this).val(i.join("")),void(this.selectionStart=this.selectionEnd=l-1>0?l-1:0)):(i.splice(this.selectionStart,this.selectionEnd-this.selectionStart,String.fromCharCode(t.which)),e(this).val(i.join("")),void(this.selectionStart=this.selectionEnd=l+1))}),this.element.find(".sh-key").on("click",function(){t.onKeyClicked(this)})},toggleShift:function(){this.element.toggleClass("alt"),this.shift=!this.shift},toggleCapsLock:function(){this.element.toggleClass("capslock"),this.capsLock=!this.capsLock},onKeyClicked:function(t){var a=e(t).data(),s=-1;if(a.ctrl)switch(a.keyCode){case"Tab":s="	".charCodeAt(0);break;case"Enter":s="\n".charCodeAt(0);break;case"Backspace":s=8;break;case"Space":s=" ".charCodeAt(0);break;case"CapsLock":return void this.toggleCapsLock();case"Shift":return void this.toggleShift()}else s=this.shift?a.alt.charCodeAt(0):(this.capsLock?a.base.toUpperCase():a.base).charCodeAt(0);var l=jQuery.Event("keydown",{which:s,keyCode:s});this.input.trigger(l)},setLayout:function(t){this.layout=t;var a=this.element?this.element.parent():null;e(this.element).remove(),this.render(a)},dispose:function(){this.element&&this.element.remove()},render:function(t){var a,s,l,i,n,o,h=t||e("body");for(this.element=e("<div>").addClass("sh-keyboard").append(e("<div>").addClass("sh-keyboard-input").append(e("<textarea>").addClass("sh-keyboard-textarea").attr("readonly","readonly"))).appendTo(h),this.element.data("__SH_KEYBOARD__",this),s=0,l=this.layout.length;l>s;s++)for(a=e("<div>").addClass("sh-keys-row").appendTo(this.element),i=0,n=this.layout[s].length;n>i;i++)o=this.layout[s][i],a.append(e("<div>").data(o).addClass("sh-key").addClass(o.ctrl?"sh-ctrl-key":"sh-char-key").addClass(o.className?o.className:"sh-no-class").attr("key-size",o.keySize||"1").append(e("<span>").addClass("sh-base").html(o.base)).append(e("<span>").addClass("sh-alt").html(o.alt))).appendTo(a);this._attachEvents()}},window.shKeyboard=t}(jQuery);